<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>SportAI Pro</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        /* CSS Variables - Dark Theme by Default */
        :root {
            /* Dark Theme (Default) */
            --bg-primary: #000000;
            --bg-secondary: #111111;
            --bg-tertiary: #1A1A1A;
            --text-primary: #FFFFFF;
            --text-secondary: #CCCCCC;
            --text-tertiary: #999999;
            --border-color: #333333;
            --border-light: #444444;
            --accent-color: #FFFFFF;
            --accent-secondary: #666666;
            --success-color: #10B981;
            --warning-color: #F59E0B;
            --danger-color: #EF4444;
            
            /* Уменьшено на 20% от оригинальных */
            --spacing-xs: 4px;
            --spacing-sm: 8px;
            --spacing-md: 12px;
            --spacing-lg: 16px;
            --spacing-xl: 20px;
            --spacing-xxl: 32px;
            
            /* Typography - Уменьшено на 20% */
            --font-xs: 12px;
            --font-sm: 14px;
            --font-base: 18px;
            --font-lg: 21px;
            --font-xl: 26px;
            --font-xxl: 32px;
            
            /* Border Radius */
            --radius-sm: 4px;
            --radius: 8px;
            --radius-lg: 12px;
            
            /* Line Height - For Readability */
            --line-height: 1.4;
            
            /* Transitions */
            --transition-fast: 0.15s ease;
            --transition-base: 0.3s ease;
            --transition-slow: 0.5s ease;
            
            /* Shadows */
            --shadow-sm: 0 1px 4px rgba(0, 0, 0, 0.3);
            --shadow-md: 0 2px 8px rgba(0, 0, 0, 0.4);
            --shadow-lg: 0 4px 16px rgba(0, 0, 0, 0.5);
        }
        
        /* Light Theme Variables */
        [data-theme="light"] {
            --bg-primary: #FFFFFF;
            --bg-secondary: #F5F5F5;
            --bg-tertiary: #EEEEEE;
            --text-primary: #000000;
            --text-secondary: #333333;
            --text-tertiary: #666666;
            --border-color: #DDDDDD;
            --border-light: #EEEEEE;
            --accent-color: #000000;
            --accent-secondary: #888888;
        }

        /* Reset & Base Styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        html {
            font-size: 16px; /* Уменьшено с 20px */
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            line-height: var(--line-height);
            font-weight: 400;
            font-size: var(--font-base);
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* App Container */
        .app-container {
            min-height: 100vh;
            max-width: 100%;
            display: flex;
            flex-direction: column;
        }

        /* Header */
        .header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            height: 56px; /* Уменьшено с 72px */
            background: var(--bg-secondary);
            border-bottom: 1px solid var(--border-color);
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 var(--spacing-lg);
            z-index: 1000;
            backdrop-filter: blur(20px);
            background-color: rgba(17, 17, 17, 0.95);
        }

        [data-theme="light"] .header {
            background-color: rgba(245, 245, 245, 0.95);
        }

        .logo {
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
        }

        .logo-icon {
            width: 28px; /* Уменьшено с 36px */
            height: 28px;
        }

        .logo-text {
            font-size: var(--font-lg);
            font-weight: 600;
            letter-spacing: -0.02em;
        }

        .header-actions {
            display: flex;
            align-items: center;
            gap: var(--spacing-md);
        }

        .profile-btn {
            width: 40px; /* Уменьшено с 48px */
            height: 40px;
            border-radius: 50%;
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: var(--transition-base);
        }

        .profile-btn:hover {
            background: var(--border-color);
        }

        /* Main Content */
        .main {
            flex: 1;
            padding: 60px var(--spacing-lg) 60px; /* Уменьшено для header и nav */
            display: flex;
            flex-direction: column;
            gap: var(--spacing-xl);
            max-width: 800px;
            margin: 0 auto;
            width: 100%;
        }

        /* Sections */
        .section {
            display: none;
            flex-direction: column;
            gap: var(--spacing-xl);
            animation: fadeIn 0.4s ease;
        }

        .section.active {
            display: flex;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Onboarding */
        .onboarding {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: var(--bg-primary);
            z-index: 2000;
            display: flex;
            flex-direction: column;
            padding: var(--spacing-lg);
            gap: var(--spacing-lg);
            overflow-y: auto;
        }

        .onboarding.hidden {
            display: none;
        }

        .onboarding-step {
            display: none;
            flex-direction: column;
            gap: var(--spacing-lg);
            flex: 1;
        }

        .onboarding-step.active {
            display: flex;
        }

        .onboarding-progress {
            display: flex;
            gap: var(--spacing-xs);
            margin-bottom: var(--spacing-md);
        }

        .progress-step {
            flex: 1;
            height: 3px;
            background: var(--border-color);
            border-radius: 1px;
            transition: var(--transition-base);
        }

        .progress-step.active {
            background: var(--accent-color);
        }

        /* Test Grid Layout */
        .test-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: var(--spacing-sm);
            margin: var(--spacing-md) 0;
        }

        .test-option-btn {
            padding: var(--spacing-sm);
            border: 1px solid var(--border-color);
            border-radius: var(--radius);
            background: var(--bg-secondary);
            color: var(--text-primary);
            font-size: var(--font-sm);
            font-weight: 500;
            cursor: pointer;
            transition: var(--transition-base);
            min-height: 44px;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
        }

        .test-option-btn:hover {
            background: var(--bg-tertiary);
            border-color: var(--accent-color);
        }

        .test-option-btn.selected {
            background: var(--accent-color);
            color: var(--bg-primary);
            border-color: var(--accent-color);
        }

        /* Typography */
        .h1 {
            font-size: var(--font-xxl);
            font-weight: 700;
            letter-spacing: -0.03em;
            line-height: 1.2;
            margin-bottom: var(--spacing-xs);
        }

        .h2 {
            font-size: var(--font-xl);
            font-weight: 600;
            letter-spacing: -0.02em;
            margin-bottom: var(--spacing-sm);
        }

        .h3 {
            font-size: var(--font-lg);
            font-weight: 600;
            margin-bottom: var(--spacing-sm);
        }

        .subtitle {
            font-size: var(--font-sm);
            color: var(--text-secondary);
            line-height: var(--line-height);
            margin-bottom: var(--spacing-md);
        }

        .caption {
            font-size: var(--font-xs);
            color: var(--text-tertiary);
            text-transform: uppercase;
            letter-spacing: 0.05em;
            font-weight: 500;
        }

        /* Cards */
        .card {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: var(--radius);
            padding: var(--spacing-md);
            transition: var(--transition-base);
        }

        .card:hover {
            border-color: var(--border-light);
            box-shadow: var(--shadow-md);
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: var(--spacing-sm);
        }

        /* Forms */
        .form-group {
            margin-bottom: var(--spacing-md);
        }

        .form-label {
            display: block;
            font-size: var(--font-sm);
            font-weight: 500;
            color: var(--text-secondary);
            margin-bottom: var(--spacing-xs);
        }

        .form-input {
            width: 100%;
            padding: var(--spacing-sm);
            border: 1px solid var(--border-color);
            border-radius: var(--radius);
            font-size: var(--font-base);
            font-family: inherit;
            background: var(--bg-primary);
            color: var(--text-primary);
            transition: var(--transition-base);
            line-height: var(--line-height);
        }

        .form-input:focus {
            outline: none;
            border-color: var(--accent-color);
            box-shadow: 0 0 0 2px rgba(255, 255, 255, 0.1);
        }

        [data-theme="light"] .form-input:focus {
            box-shadow: 0 0 0 2px rgba(0, 0, 0, 0.1);
        }

        .form-row {
            display: flex;
            gap: var(--spacing-sm);
            margin-bottom: var(--spacing-sm);
        }

        .form-col {
            flex: 1;
        }

        /* Buttons */
        .btn {
            padding: var(--spacing-sm) var(--spacing-md);
            border: 1px solid var(--border-color);
            border-radius: var(--radius);
            font-size: var(--font-base);
            font-weight: 500;
            font-family: inherit;
            cursor: pointer;
            transition: var(--transition-base);
            background: var(--bg-secondary);
            color: var(--text-primary);
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: var(--spacing-xs);
            text-align: center;
            text-decoration: none;
            min-height: 44px; /* Уменьшено с 60px */
            line-height: var(--line-height);
        }

        .btn:hover {
            background: var(--bg-tertiary);
            transform: translateY(-1px);
            box-shadow: var(--shadow-md);
        }

        .btn-primary {
            background: var(--accent-color);
            color: var(--bg-primary);
            border-color: var(--accent-color);
        }

        .btn-primary:hover {
            background: var(--text-secondary);
            border-color: var(--text-secondary);
        }

        .btn-block {
            width: 100%;
        }

        .btn-sm {
            padding: var(--spacing-xs) var(--spacing-sm);
            font-size: var(--font-sm);
            min-height: 36px; /* Уменьшено с 48px */
        }

        .icon-btn {
            width: 20px; /* Уменьшено с 24px */
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* Test Components */
        .test-area {
            width: 100%;
            height: 250px; /* Уменьшено с 360px */
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            border-radius: var(--radius);
            position: relative;
            overflow: hidden;
            margin: var(--spacing-md) 0;
        }

        .reaction-target {
            position: absolute;
            width: 56px; /* Уменьшено с 72px */
            height: 56px;
            background: var(--accent-color);
            border-radius: 50%;
            cursor: pointer;
            transform: translate(-50%, -50%);
            transition: transform 0.1s;
        }

        .test-stats {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: var(--spacing-sm);
            margin-top: var(--spacing-md);
        }

        .stat-box {
            padding: var(--spacing-sm);
            border: 1px solid var(--border-color);
            border-radius: var(--radius);
            text-align: center;
        }

        .stat-value {
            font-size: var(--font-lg);
            font-weight: 600;
            margin-bottom: var(--spacing-xs);
        }

        .stat-label {
            font-size: var(--font-xs);
            color: var(--text-tertiary);
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        /* Home - Main Hub */
        .welcome-section {
            margin-bottom: var(--spacing-lg);
        }

        .greeting {
            font-size: var(--font-lg);
            font-weight: 600;
            margin-bottom: var(--spacing-xs);
        }

        .time-based-section {
            margin-bottom: var(--spacing-lg);
        }

        .time-indicator {
            display: inline-flex;
            align-items: center;
            gap: var(--spacing-xs);
            padding: var(--spacing-xs) var(--spacing-sm);
            background: var(--bg-tertiary);
            border-radius: var(--radius);
            margin-bottom: var(--spacing-sm);
            font-weight: 500;
        }

        .time-icon {
            width: 16px; /* Уменьшено */
            height: 16px;
        }

        .favorite-sport {
            margin-bottom: var(--spacing-lg);
        }

        .sport-card-large {
            padding: var(--spacing-md);
            border: 1px solid var(--border-color);
            border-radius: var(--radius);
            display: flex;
            align-items: center;
            gap: var(--spacing-md);
            transition: var(--transition-base);
            cursor: pointer;
        }

        .sport-card-large:hover {
            border-color: var(--border-light);
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        .sport-icon-large {
            width: 56px; /* Уменьшено с 72px */
            height: 56px;
            flex-shrink: 0;
        }

        .sport-info {
            flex: 1;
        }

        .sport-name {
            font-size: var(--font-base);
            font-weight: 600;
            margin-bottom: var(--spacing-xs);
        }

        .sport-desc {
            color: var(--text-secondary);
            font-size: var(--font-sm);
            line-height: var(--line-height);
        }

        /* Sports Grid */
        .sports-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(130px, 1fr));
            gap: var(--spacing-sm);
            margin: var(--spacing-md) 0;
        }

        .sport-card {
            padding: var(--spacing-md);
            border: 1px solid var(--border-color);
            border-radius: var(--radius);
            text-align: center;
            cursor: pointer;
            transition: var(--transition-base);
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: var(--spacing-xs);
            position: relative;
        }

        .sport-card:hover {
            border-color: var(--accent-color);
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        .sport-card.favorite {
            border-color: var(--warning-color);
            background: linear-gradient(135deg, rgba(245, 158, 11, 0.1), transparent);
        }

        .favorite-star {
            position: absolute;
            top: var(--spacing-xs);
            right: var(--spacing-xs);
            width: 20px; /* Уменьшено */
            height: 20px;
            cursor: pointer;
            transition: var(--transition-base);
        }

        .favorite-star:hover {
            transform: scale(1.1);
        }

        .sport-icon {
            width: 40px; /* Уменьшено с 48px */
            height: 40px;
            margin-bottom: var(--spacing-xs);
        }

        /* Today Recommendations */
        .today-recommendations {
            margin: var(--spacing-lg) 0;
        }

        .recommendation-card {
            padding: var(--spacing-md);
            border: 1px solid var(--border-color);
            border-radius: var(--radius);
            margin-bottom: var(--spacing-sm);
            background: var(--bg-secondary);
        }

        .recommendation-header {
            display: flex;
            align-items: center;
            gap: var(--spacing-xs);
            margin-bottom: var(--spacing-sm);
        }

        .recommendation-icon {
            width: 24px; /* Уменьшено */
            height: 24px;
        }

        .recommendation-title {
            font-size: var(--font-base);
            font-weight: 600;
        }

        .recommendation-list {
            list-style: none;
        }

        .recommendation-item {
            padding: var(--spacing-xs) 0;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            align-items: center;
            gap: var(--spacing-xs);
            line-height: var(--line-height);
            font-size: var(--font-sm);
        }

        .recommendation-item:last-child {
            border-bottom: none;
        }

        .check-icon {
            width: 16px; /* Уменьшено */
            height: 16px;
            color: var(--success-color);
            flex-shrink: 0;
        }

        /* Profile Section */
        .profile-header {
            display: flex;
            align-items: center;
            gap: var(--spacing-md);
            margin-bottom: var(--spacing-lg);
        }

        .profile-avatar {
            width: 72px; /* Уменьшено с 96px */
            height: 72px;
            border-radius: 50%;
            background: var(--bg-tertiary);
            border: 2px solid var(--border-color);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: var(--font-lg);
            font-weight: 600;
        }

        .profile-info {
            flex: 1;
        }

        .profile-name {
            font-size: var(--font-lg);
            font-weight: 600;
            margin-bottom: var(--spacing-xs);
        }

        .profile-meta {
            color: var(--text-secondary);
            font-size: var(--font-sm);
        }

        .profile-stats {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: var(--spacing-sm);
            margin: var(--spacing-lg) 0;
        }

        .profile-stat-card {
            padding: var(--spacing-md);
            border: 1px solid var(--border-color);
            border-radius: var(--radius);
            text-align: center;
            background: var(--bg-secondary);
        }

        .profile-stat-value {
            font-size: var(--font-lg);
            font-weight: 600;
            margin-bottom: var(--spacing-xs);
        }

        .personal-records {
            margin: var(--spacing-lg) 0;
        }

        .record-list {
            list-style: none;
        }

        .record-item {
            padding: var(--spacing-sm);
            border: 1px solid var(--border-color);
            border-radius: var(--radius);
            margin-bottom: var(--spacing-sm);
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: var(--bg-secondary);
        }

        .record-info {
            flex: 1;
        }

        .record-name {
            font-weight: 500;
            margin-bottom: var(--spacing-xs);
        }

        .record-date {
            color: var(--text-tertiary);
            font-size: var(--font-xs);
        }

        .record-value {
            font-size: var(--font-base);
            font-weight: 600;
            color: var(--success-color);
        }

        /* Analysis Section */
        .analysis-tabs {
            display: flex;
            gap: var(--spacing-xs);
            background: var(--bg-tertiary);
            padding: var(--spacing-xs);
            border-radius: var(--radius);
            margin-bottom: var(--spacing-md);
        }

        .analysis-tab {
            flex: 1;
            padding: var(--spacing-sm);
            border: none;
            background: transparent;
            color: var(--text-tertiary);
            font-size: var(--font-sm);
            font-weight: 500;
            cursor: pointer;
            border-radius: var(--radius-sm);
            transition: var(--transition-base);
        }

        .analysis-tab.active {
            background: var(--bg-secondary);
            color: var(--text-primary);
        }

        .analysis-content {
            display: none;
        }

        .analysis-content.active {
            display: block;
        }

        /* Sport Details Modal */
        .sport-details-modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: var(--bg-primary);
            z-index: 3000;
            overflow-y: auto;
            padding: var(--spacing-lg);
            display: none;
        }

        .sport-details-modal.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        .sport-details-header {
            display: flex;
            align-items: center;
            gap: var(--spacing-md);
            margin-bottom: var(--spacing-lg);
            padding-bottom: var(--spacing-md);
            border-bottom: 1px solid var(--border-color);
        }

        .sport-details-content {
            max-width: 800px;
            margin: 0 auto;
        }

        .sport-details-section {
            margin-bottom: var(--spacing-xl);
            padding: var(--spacing-lg);
            border: 1px solid var(--border-color);
            border-radius: var(--radius);
            background: var(--bg-secondary);
        }

        .sport-details-section h3 {
            margin-bottom: var(--spacing-md);
            color: var(--accent-color);
        }

        .workout-list {
            list-style: none;
            margin: var(--spacing-md) 0;
        }

        .workout-item {
            padding: var(--spacing-md);
            margin-bottom: var(--spacing-sm);
            border: 1px solid var(--border-light);
            border-radius: var(--radius);
            background: var(--bg-tertiary);
        }

        .workout-name {
            font-weight: 600;
            margin-bottom: var(--spacing-xs);
            color: var(--text-primary);
        }

        .workout-details {
            font-size: var(--font-sm);
            color: var(--text-secondary);
            margin-bottom: var(--spacing-xs);
        }

        .nutrition-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: var(--spacing-md);
            margin: var(--spacing-md) 0;
        }

        .nutrition-item {
            padding: var(--spacing-md);
            border: 1px solid var(--border-light);
            border-radius: var(--radius);
            text-align: center;
            background: var(--bg-tertiary);
        }

        .nutrition-value {
            font-size: var(--font-lg);
            font-weight: 600;
            color: var(--success-color);
            margin-bottom: var(--spacing-xs);
        }

        .nutrition-label {
            font-size: var(--font-xs);
            color: var(--text-tertiary);
            text-transform: uppercase;
        }

        .supplements-list {
            margin: var(--spacing-md) 0;
        }

        .supplement-item {
            padding: var(--spacing-md);
            margin-bottom: var(--spacing-sm);
            border: 1px solid var(--border-light);
            border-radius: var(--radius);
            background: var(--bg-tertiary);
        }

        .supplement-name {
            font-weight: 600;
            margin-bottom: var(--spacing-xs);
            color: var(--text-primary);
        }

        .supplement-desc {
            font-size: var(--font-sm);
            color: var(--text-secondary);
            margin-bottom: var(--spacing-xs);
        }

        .disclaimer {
            padding: var(--spacing-md);
            margin-top: var(--spacing-md);
            border: 1px solid var(--warning-color);
            border-radius: var(--radius);
            background: rgba(245, 158, 11, 0.1);
            color: var(--warning-color);
            font-size: var(--font-sm);
            text-align: center;
        }

        .gym-goal-selector {
            display: flex;
            gap: var(--spacing-sm);
            margin-bottom: var(--spacing-lg);
        }

        .goal-btn {
            flex: 1;
            padding: var(--spacing-sm);
            border: 1px solid var(--border-color);
            background: var(--bg-tertiary);
            color: var(--text-secondary);
            border-radius: var(--radius);
            cursor: pointer;
            font-size: var(--font-sm);
            font-weight: 500;
            transition: var(--transition-base);
        }

        .goal-btn.active {
            background: var(--accent-color);
            color: var(--bg-primary);
            border-color: var(--accent-color);
        }

        /* Navigation */
        .nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: var(--bg-secondary);
            border-top: 1px solid var(--border-color);
            display: flex;
            padding: var(--spacing-xs) var(--spacing-md);
            gap: var(--spacing-xs);
            z-index: 1000;
            backdrop-filter: blur(20px);
            background-color: rgba(17, 17, 17, 0.95);
        }

        [data-theme="light"] .nav {
            background-color: rgba(245, 245, 245, 0.95);
        }

        .nav-btn {
            flex: 1;
            padding: var(--spacing-xs) var(--spacing-sm);
            border: none;
            background: transparent;
            color: var(--text-tertiary);
            font-size: var(--font-xs);
            font-weight: 500;
            cursor: pointer;
            border-radius: var(--radius);
            transition: var(--transition-base);
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 2px;
        }

        .nav-btn:hover {
            background: var(--bg-tertiary);
        }

        .nav-btn.active {
            color: var(--accent-color);
            background: var(--bg-tertiary);
        }

        .nav-icon {
            width: 20px; /* Уменьшено */
            height: 20px;
        }

        /* Loading */
        .loading {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: var(--spacing-xs);
            padding: var(--spacing-lg);
        }

        .spinner {
            width: 24px; /* Уменьшено */
            height: 24px;
            border: 2px solid var(--border-color);
            border-top-color: var(--accent-color);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Test Results Modal */
        .test-results-modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: var(--bg-primary);
            z-index: 3000;
            display: flex;
            flex-direction: column;
            padding: var(--spacing-lg);
            gap: var(--spacing-lg);
            animation: fadeIn 0.3s ease;
        }

        .test-results-modal.hidden {
            display: none;
        }

        /* Utility Classes */
        .mt-1 { margin-top: var(--spacing-xs); }
        .mt-2 { margin-top: var(--spacing-sm); }
        .mt-3 { margin-top: var(--spacing-md); }
        .mt-4 { margin-top: var(--spacing-lg); }
        .mt-6 { margin-top: var(--spacing-xl); }
        .mb-1 { margin-bottom: var(--spacing-xs); }
        .mb-2 { margin-bottom: var(--spacing-sm); }
        .mb-3 { margin-bottom: var(--spacing-md); }
        .mb-4 { margin-bottom: var(--spacing-lg); }
        .mb-6 { margin-bottom: var(--spacing-xl); }
        .text-center { text-align: center; }
        .text-muted { color: var(--text-tertiary); }
        .d-none { display: none !important; }
        .d-flex { display: flex; }
        .d-block { display: block; }
        .flex-column { flex-direction: column; }
        .align-center { align-items: center; }
        .justify-center { justify-content: center; }
        .gap-2 { gap: var(--spacing-sm); }
        .gap-4 { gap: var(--spacing-md); }
        .gap-6 { gap: var(--spacing-lg); }
        .w-100 { width: 100%; }

        /* Responsive */
        @media (max-width: 768px) {
            .main {
                padding: 60px var(--spacing-sm) 60px;
            }
            
            .header {
                padding: 0 var(--spacing-sm);
            }
            
            .nav {
                padding: var(--spacing-xs) var(--spacing-sm);
            }
            
            .form-row {
                flex-direction: column;
                gap: var(--spacing-xs);
            }
            
            .sports-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .profile-stats {
                grid-template-columns: 1fr;
            }
            
            .nutrition-grid {
                grid-template-columns: 1fr;
            }
            
            .gym-goal-selector {
                flex-direction: column;
            }
        }

        @media (max-width: 480px) {
            .main {
                padding: 60px var(--spacing-xs) 60px;
            }
            
            .onboarding {
                padding: var(--spacing-md);
            }
            
            .sport-card-large {
                flex-direction: column;
                text-align: center;
                gap: var(--spacing-sm);
            }
            
            .profile-header {
                flex-direction: column;
                text-align: center;
                gap: var(--spacing-sm);
            }
            
            .sports-grid {
                grid-template-columns: 1fr;
            }
            
            .test-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="app-container">
        <!-- Onboarding Screen (Fullscreen) -->
        <div class="onboarding" id="onboarding">
            <!-- Step 1: Welcome -->
            <div class="onboarding-step active" id="onboardingStep1">
                <div class="onboarding-progress">
                    <div class="progress-step active"></div>
                    <div class="progress-step"></div>
                    <div class="progress-step"></div>
                    <div class="progress-step"></div>
                </div>
                
                <div class="card">
                    <h1 class="h1">Добро пожаловать в SportAI Pro</h1>
                    <p class="subtitle">Персональный тренер, который подберет идеальный спорт и программу тренировок на основе ваших данных.</p>
                    
                    <div class="mt-4">
                        <h3 class="h3">Как это работает:</h3>
                        <div class="d-flex flex-column gap-4 mt-2">
                            <div class="d-flex gap-3 align-center">
                                <div style="width: 32px; height: 32px; background: var(--bg-tertiary); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 600;">1</div>
                                <div>
                                    <div style="font-weight: 500;">Ввод данных</div>
                                    <div class="text-muted">Рост, вес, возраст и замеры тела</div>
                                </div>
                            </div>
                            <div class="d-flex gap-3 align-center">
                                <div style="width: 32px; height: 32px; background: var(--bg-tertiary); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 600;">2</div>
                                <div>
                                    <div style="font-weight: 500;">Тестирование</div>
                                    <div class="text-muted">Реакция и упражнения с весом тела</div>
                                </div>
                            </div>
                            <div class="d-flex gap-3 align-center">
                                <div style="width: 32px; height: 32px; background: var(--bg-tertiary); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 600;">3</div>
                                <div>
                                    <div style="font-weight: 500;">Анализ</div>
                                    <div class="text-muted">AI подбирает лучший спорт и программу</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <button class="btn btn-primary btn-block mt-4" onclick="SportAI.onboardingNext()">
                        Начать настройку →
                    </button>
                </div>
            </div>

            <!-- Step 2: Basic Data -->
            <div class="onboarding-step" id="onboardingStep2">
                <div class="onboarding-progress">
                    <div class="progress-step active"></div>
                    <div class="progress-step active"></div>
                    <div class="progress-step"></div>
                    <div class="progress-step"></div>
                </div>
                
                <div class="card">
                    <h2 class="h2">Ваши базовые данные</h2>
                    <p class="subtitle">Эти данные нужны для точного расчета соматотипа и рекомендаций</p>
                    
                    <div class="form-row">
                        <div class="form-col">
                            <label class="form-label">Возраст</label>
                            <input type="number" class="form-input" id="age" min="14" max="80" placeholder="25">
                        </div>
                        <div class="form-col">
                            <label class="form-label">Пол</label>
                            <select class="form-input" id="gender">
                                <option value="">Выбрать</option>
                                <option value="male">Мужской</option>
                                <option value="female">Женский</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-col">
                            <label class="form-label">Рост (см)</label>
                            <input type="number" class="form-input" id="height" min="120" max="220" placeholder="175">
                        </div>
                        <div class="form-col">
                            <label class="form-label">Вес (кг)</label>
                            <input type="number" class="form-input" id="weight" min="30" max="150" placeholder="70">
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-col">
                            <label class="form-label">Обхват запястья (см)</label>
                            <input type="number" class="form-input" id="wrist" min="12" max="25" step="0.1" placeholder="16.5">
                            <div class="caption mt-1">Измерьте самую тонкую часть запястья</div>
                        </div>
                        <div class="form-col">
                            <label class="form-label">Обхват щиколотки (см)</label>
                            <input type="number" class="form-input" id="ankle" min="15" max="30" step="0.1" placeholder="22.5">
                            <div class="caption mt-1">Над косточкой щиколотки</div>
                        </div>
                    </div>
                    
                    <div class="d-flex gap-3 mt-4">
                        <button class="btn" onclick="SportAI.onboardingPrev()">
                            ← Назад
                        </button>
                        <button class="btn btn-primary" onclick="SportAI.onboardingNext()">
                            Далее: Тест реакции →
                        </button>
                    </div>
                </div>
            </div>

            <!-- Step 3: Reaction Test -->
            <div class="onboarding-step" id="onboardingStep3">
                <div class="onboarding-progress">
                    <div class="progress-step active"></div>
                    <div class="progress-step active"></div>
                    <div class="progress-step active"></div>
                    <div class="progress-step"></div>
                </div>
                
                <div class="card">
                    <h2 class="h2">Тест на скорость реакции</h2>
                    <p class="subtitle">Нажимайте на появляющиеся круги как можно быстрее. Тест займет 30 секунд.</p>
                    
                    <div class="test-area" id="reactionArea">
                        <div class="text-center" style="margin-top: 100px; color: var(--text-tertiary);" id="reactionMessage">
                            Нажмите "Начать тест"
                        </div>
                    </div>
                    
                    <div class="test-stats">
                        <div class="stat-box">
                            <div class="stat-value" id="reactionAvg">-</div>
                            <div class="stat-label">Среднее время (мс)</div>
                        </div>
                        <div class="stat-box">
                            <div class="stat-value" id="reactionBest">-</div>
                            <div class="stat-label">Лучшее время (мс)</div>
                        </div>
                    </div>
                    
                    <div class="d-flex gap-3">
                        <button class="btn" onclick="SportAI.onboardingPrev()">
                            ← Назад
                        </button>
                        <button class="btn btn-primary" id="startReaction" onclick="SportAI.startReactionTest()">
                            Начать тест
                        </button>
                        <button class="btn btn-primary d-none" id="continueBtn" onclick="SportAI.onboardingNext()">
                            Продолжить →
                        </button>
                    </div>
                </div>
            </div>

            <!-- Step 4: Bodyweight Test -->
            <div class="onboarding-step" id="onboardingStep4">
                <div class="onboarding-progress">
                    <div class="progress-step active"></div>
                    <div class="progress-step active"></div>
                    <div class="progress-step active"></div>
                    <div class="progress-step active"></div>
                </div>
                
                <div class="card">
                    <h2 class="h2">Тест с весом тела</h2>
                    <p class="subtitle">Введите свои максимальные результаты. Если не можете выполнить - введите 0.</p>
                    
                    <div class="form-group">
                        <label class="form-label">Сколько раз можете отжаться? (полные отжимания)</label>
                        <input type="number" class="form-input" id="pushups" placeholder="0" min="0" value="0">
                        <div class="caption mt-1">Лягте на пол, руки на ширине плеч, опуститесь до угла 90° в локтях</div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Сколько секунд можете простоять в планке?</label>
                        <input type="number" class="form-input" id="plank" placeholder="0" min="0" value="0">
                        <div class="caption mt-1">На локтях, тело прямое, таз не провисает</div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Сколько раз можете подтянуться?</label>
                        <input type="number" class="form-input" id="pullups" placeholder="0" min="0" value="0">
                        <div class="caption mt-1">Если не можете - введите 0. Используйте прямой хват</div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Сколько раз присядете за 1 минуту?</label>
                        <input type="number" class="form-input" id="squats" placeholder="0" min="0" value="0">
                        <div class="caption mt-1">Без веса, бедра параллельны полу, спина прямая</div>
                    </div>
                    
                    <!-- Тест выбора спортивных предпочтений -->
                    <div class="form-group mt-4">
                        <label class="form-label">Какие виды активности вам больше нравятся? (можно выбрать несколько)</label>
                        <div class="test-grid" id="sportPreferences">
                            <button class="test-option-btn" data-value="team">Командные игры</button>
                            <button class="test-option-btn" data-value="strength">Силовые</button>
                            <button class="test-option-btn" data-value="endurance">Выносливость</button>
                            <button class="test-option-btn" data-value="coordination">Координация</button>
                            <button class="test-option-btn" data-value="water">Водные виды</button>
                            <button class="test-option-btn" data-value="martial">Боевые искусства</button>
                        </div>
                    </div>
                    
                    <div class="mt-3">
                        <div class="caption mb-1">Уровень подготовки:</div>
                        <div class="stat-value" id="fitnessLevel">Не определен</div>
                        <div class="text-muted mt-1" id="fitnessDescription"></div>
                    </div>
                    
                    <div class="d-flex gap-3 mt-4">
                        <button class="btn" onclick="SportAI.onboardingPrev()">
                            ← Назад
                        </button>
                        <button class="btn btn-primary btn-block" onclick="SportAI.completeOnboarding()">
                            Завершить настройку
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Sport Details Modal -->
        <div class="sport-details-modal" id="sportDetailsModal">
            <div class="sport-details-content">
                <div class="sport-details-header">
                    <button class="btn btn-sm" onclick="SportAI.closeSportDetails()">← Назад</button>
                    <h2 class="h2" id="sportDetailsTitle">Название спорта</h2>
                </div>
                
                <!-- Для зала показываем переключатель целей -->
                <div class="gym-goal-selector d-none" id="gymGoalSelector">
                    <button class="goal-btn active" data-goal="muscle">Набор мышц</button>
                    <button class="goal-btn" data-goal="shape">Форма и рельеф</button>
                </div>
                
                <!-- Тренировки -->
                <div class="sport-details-section">
                    <h3 class="h3">Тренировочная программа</h3>
                    <ul class="workout-list" id="workoutList">
                        <!-- Заполняется JavaScript -->
                    </ul>
                </div>
                
                <!-- Питание -->
                <div class="sport-details-section">
                    <h3 class="h3">Питание и КБЖУ</h3>
                    <div class="nutrition-grid" id="nutritionGrid">
                        <!-- Заполняется JavaScript -->
                    </div>
                    <div class="mt-3">
                        <strong>Рекомендации по питанию:</strong>
                        <div id="nutritionTips"></div>
                    </div>
                </div>
                
                <!-- Добавки -->
                <div class="sport-details-section">
                    <h3 class="h3">Добавки и БАДы</h3>
                    <div class="supplements-list" id="supplementsList">
                        <!-- Заполняется JavaScript -->
                    </div>
                    <div class="disclaimer">
                        <strong>Важно:</strong> Перед приемом любых добавок проконсультируйтесь с врачом. 
                        Данные рекомендации носят ознакомительный характер.
                    </div>
                </div>
            </div>
        </div>

        <!-- Main App (Hidden until onboarding complete) -->
        <div id="mainApp" class="d-none">
            <!-- Header -->
            <header class="header">
                <div class="logo">
                    <svg class="logo-icon" viewBox="0 0 36 36" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M18 3C9.72 3 3 9.72 3 18C3 26.28 9.72 33 18 33C26.28 33 33 26.28 33 18C33 9.72 26.28 3 18 3Z" stroke="currentColor" stroke-width="2.5"/>
                        <path d="M18 24C21.3137 24 24 21.3137 24 18C24 14.6863 21.3137 12 18 12C14.6863 12 12 14.6863 12 18C12 21.3137 14.6863 24 18 24Z" stroke="currentColor" stroke-width="2.5"/>
                        <path d="M18 30C23.5228 30 28 25.5228 28 20C28 14.4772 23.5228 10 18 10C12.4772 10 8 14.4772 8 20C8 25.5228 12.4772 30 18 30Z" stroke="currentColor" stroke-width="1.5"/>
                    </svg>
                    <span class="logo-text">SportAI Pro</span>
                </div>
                
                <div class="header-actions">
                    <div class="profile-btn" onclick="SportAI.showSection('profile')">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M12 12C14.2091 12 16 10.2091 16 8C16 5.79086 14.2091 4 12 4C9.79086 4 8 5.79086 8 8C8 10.2091 9.79086 12 12 12Z" stroke="currentColor" stroke-width="2"/>
                            <path d="M20 21V19C20 17.9391 19.5786 16.9217 18.8284 16.1716C18.0783 15.4214 17.0609 15 16 15H8C6.93913 15 5.92172 15.4214 5.17157 16.1716C4.42143 16.9217 4 17.9391 4 19V21" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                    </div>
                </div>
            </header>

            <!-- Main Content -->
            <main class="main">
                <!-- Home Section -->
                <section id="home" class="section active">
                    <!-- Welcome Section -->
                    <div class="welcome-section">
                        <div class="greeting" id="greetingText">Доброе утро!</div>
                        <p class="subtitle">Ваши рекомендации на сегодня</p>
                    </div>

                    <!-- Time-Based Section -->
                    <div class="time-based-section">
                        <div class="time-indicator" id="timeIndicator">
                            <svg class="time-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M12 8V12L15 15" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                                <circle cx="12" cy="12" r="9" stroke="currentColor" stroke-width="2"/>
                            </svg>
                            <span id="timePeriod">Утренние рекомендации</span>
                        </div>
                        
                        <div class="today-recommendations" id="todayRecommendations">
                            <!-- Filled by JavaScript -->
                        </div>
                    </div>

                    <!-- Favorite Sport -->
                    <div class="favorite-sport" id="favoriteSportSection">
                        <!-- Filled by JavaScript -->
                    </div>

                    <!-- Quick Actions -->
                    <div class="card">
                        <h3 class="h3">Быстрые действия</h3>
                        <div class="d-flex gap-3 mt-2">
                            <button class="btn btn-primary" onclick="SportAI.showSection('analysis')">
                                <svg class="icon-btn" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M21 21H13V15H21V21ZM11 21H3V11H11V21ZM21 13H13V3H21V13ZM11 9H3V3H11V9Z" stroke="currentColor" stroke-width="2"/>
                                </svg>
                                Анализ
                            </button>
                            <button class="btn" onclick="SportAI.showSection('sports')">
                                <svg class="icon-btn" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <circle cx="12" cy="12" r="9" stroke="currentColor" stroke-width="2"/>
                                    <path d="M12 8V16M8 12H16" stroke="currentColor" stroke-width="2"/>
                                </svg>
                                Виды спорта
                            </button>
                        </div>
                    </div>
                </section>

                <!-- Sports Section -->
                <section id="sports" class="section">
                    <div class="card">
                        <h2 class="h2">Рекомендованные виды спорта</h2>
                        <p class="subtitle">Нажмите на карточку для получения подробной программы. Звездочка - добавить в избранное.</p>
                        
                        <div class="sports-grid" id="sportsGrid">
                            <!-- Filled by JavaScript -->
                        </div>
                    </div>
                </section>

                <!-- Analysis Section -->
                <section id="analysis" class="section">
                    <div class="card">
                        <h2 class="h2">Анализ и тестирование</h2>
                        <p class="subtitle">Обновите данные или пройдите тесты заново</p>
                        
                        <div class="analysis-tabs">
                            <button class="analysis-tab active" onclick="SportAI.showAnalysisTab('data')">Данные</button>
                            <button class="analysis-tab" onclick="SportAI.showAnalysisTab('tests')">Тесты</button>
                            <button class="analysis-tab" onclick="SportAI.showAnalysisTab('results')">Результаты</button>
                        </div>
                        
                        <!-- Data Tab -->
                        <div class="analysis-content active" id="analysisData">
                            <div class="form-group">
                                <label class="form-label">Рост (см)</label>
                                <input type="number" class="form-input" id="updateHeight" placeholder="175">
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Вес (кг)</label>
                                <input type="number" class="form-input" id="updateWeight" placeholder="70">
                            </div>
                            
                            <div class="form-row">
                                <div class="form-col">
                                    <label class="form-label">Обхват запястья (см)</label>
                                    <input type="number" class="form-input" id="updateWrist" step="0.1" placeholder="16.5">
                                </div>
                                <div class="form-col">
                                    <label class="form-label">Обхват щиколотки (см)</label>
                                    <input type="number" class="form-input" id="updateAnkle" step="0.1" placeholder="22.5">
                                </div>
                            </div>
                            
                            <button class="btn btn-primary btn-block mt-3" onclick="SportAI.updateUserData()">
                                Обновить данные
                            </button>
                        </div>
                        
                        <!-- Tests Tab -->
                        <div class="analysis-content" id="analysisTests">
                            <div class="card">
                                <h3 class="h3">Тест на реакцию</h3>
                                <p class="subtitle">Проверьте скорость реакции</p>
                                <button class="btn btn-block mt-3" onclick="SportAI.startReactionTest()">
                                    Пройти тест заново
                                </button>
                            </div>
                            
                            <div class="card mt-3">
                                <h3 class="h3">Тест с весом тела</h3>
                                <p class="subtitle">Обновите свои рекорды</p>
                                
                                <div class="form-group mt-3">
                                    <label class="form-label">Отжимания (раз)</label>
                                    <input type="number" class="form-input" id="updatePushups" placeholder="0">
                                </div>
                                
                                <div class="form-group">
                                    <label class="form-label">Планка (секунд)</label>
                                    <input type="number" class="form-input" id="updatePlank" placeholder="0">
                                </div>
                                
                                <div class="form-group">
                                    <label class="form-label">Подтягивания (раз)</label>
                                    <input type="number" class="form-input" id="updatePullups" placeholder="0">
                                </div>
                                
                                <div class="form-group">
                                    <label class="form-label">Приседания за минуту (раз)</label>
                                    <input type="number" class="form-input" id="updateSquats" placeholder="0">
                                </div>
                                
                                <button class="btn btn-primary btn-block mt-3" onclick="SportAI.updateBodyweightTest()">
                                    Обновить рекорды
                                </button>
                            </div>
                        </div>
                        
                        <!-- Results Tab -->
                        <div class="analysis-content" id="analysisResults">
                            <div class="test-stats">
                                <div class="stat-box">
                                    <div class="stat-value" id="analysisReaction">-</div>
                                    <div class="stat-label">Скорость реакции</div>
                                </div>
                                <div class="stat-box">
                                    <div class="stat-value" id="analysisStrength">-</div>
                                    <div class="stat-label">Уровень силы</div>
                                </div>
                            </div>
                            
                            <div class="card mt-3">
                                <h3 class="h3">Соматотип</h3>
                                <div class="stat-value mt-1" id="analysisBodyType">Не определен</div>
                                <div class="text-muted mt-1" id="analysisBodyTypeDesc"></div>
                            </div>
                            
                            <div class="card mt-3">
                                <h3 class="h3">Индекс массы тела (BMI)</h3>
                                <div class="stat-value mt-1" id="analysisBmi">-</div>
                                <div class="text-muted mt-1" id="analysisBmiCategory"></div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Profile Section -->
                <section id="profile" class="section">
                    <div class="profile-header">
                        <div class="profile-avatar" id="profileAvatar">
                            U
                        </div>
                        <div class="profile-info">
                            <div class="profile-name" id="profileName">Пользователь</div>
                            <div class="profile-meta">
                                <div id="profileAge">Возраст не указан</div>
                                <div id="profileGender">Пол не указан</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="profile-stats">
                        <div class="profile-stat-card">
                            <div class="profile-stat-value" id="profileBmi">-</div>
                            <div class="caption">Индекс массы тела</div>
                        </div>
                        <div class="profile-stat-card">
                            <div class="profile-stat-value" id="profileBodyType">-</div>
                            <div class="caption">Соматотип</div>
                        </div>
                    </div>
                    
                    <div class="personal-records">
                        <h3 class="h3">Личные рекорды</h3>
                        <p class="subtitle">Ваши лучшие результаты в тестах</p>
                        
                        <div class="record-list" id="personalRecords">
                            <!-- Filled by JavaScript -->
                        </div>
                    </div>
                    
                    <div class="card mt-4">
                        <button class="btn btn-block" onclick="SportAI.resetApp()">
                            <svg class="icon-btn" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M12 2V6" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                                <path d="M12 18V22" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                                <path d="M4.93 4.93L7.76 7.76" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                                <path d="M16.24 16.24L19.07 19.07" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                                <path d="M2 12H6" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                                <path d="M18 12H22" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                                <path d="M4.93 19.07L7.76 16.24" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                                <path d="M16.24 7.76L19.07 4.93" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                            </svg>
                            Сбросить и начать заново
                        </button>
                    </div>
                </section>
            </main>

            <!-- Navigation -->
            <nav class="nav">
                <button class="nav-btn active" onclick="SportAI.showSection('home')">
                    <svg class="nav-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M3 9L12 2L21 9V20C21 20.5304 20.7893 21.0391 20.4142 21.4142C20.0391 21.7893 19.5304 22 19 22H5C4.46957 22 3.96086 21.7893 3.58579 21.4142C3.21071 21.0391 3 20.5304 3 20V9Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    Главная
                </button>
                <button class="nav-btn" onclick="SportAI.showSection('sports')">
                    <svg class="nav-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <circle cx="12" cy="12" r="9" stroke="currentColor" stroke-width="2"/>
                        <path d="M12 8V16M8 12H16" stroke="currentColor" stroke-width="2"/>
                    </svg>
                    Спорт
                </button>
                <button class="nav-btn" onclick="SportAI.showSection('analysis')">
                    <svg class="nav-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M21 21H13V15H21V21ZM11 21H3V11H11V21ZM21 13H13V3H21V13ZM11 9H3V3H11V9Z" stroke="currentColor" stroke-width="2"/>
                    </svg>
                    Анализ
                </button>
            </nav>
        </div>
    </div>

    <script>
        /**
         * SportAI Pro - Final Version with Detailed Recommendations
         * Версия 5.0: Полные детали по видам спорта
         */

        const SPORTS_DATABASE = {
            football: {
                id: 'football',
                name: 'Футбол',
                description: 'Командная игра, кардио, выносливость',
                icon: '<svg viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="20" cy="20" r="18" stroke="currentColor" stroke-width="2"/><path d="M20 8V32M32 20H8M28 12L12 28M28 28L12 12" stroke="currentColor" stroke-width="2"/></svg>',
                category: 'team',
                recommendations: {
                    morning: [
                        'Бег с ускорениями 4x100м',
                        'Прыжки на тумбу 3x10',
                        'Растяжка ног и тазобедренных суставов'
                    ],
                    day: [
                        'Техническая работа с мячом 45 мин',
                        'Игровые упражнения 2 на 2',
                        'Спринтерские рывки 10x20м'
                    ],
                    evening: [
                        'Восстановительный массаж ног',
                        'Анализ тактических схем',
                        'Статическая растяжка'
                    ]
                },
                workouts: [
                    { name: 'Бег с ускорениями', sets: '4-6', reps: '30-40 метров', rest: '90 секунд' },
                    { name: 'Прыжки на тумбу', sets: '3-4', reps: '10-12 повторений', rest: '60 секунд' },
                    { name: 'Приседания с весом', sets: '4', reps: '12-15 повторений', rest: '90 секунд' },
                    { name: 'Выпады с гантелями', sets: '3', reps: '12-15 на каждую ногу', rest: '60 секунд' },
                    { name: 'Планка с поднятием ноги', sets: '3', reps: '30-45 секунд', rest: '30 секунд' }
                ],
                nutrition: {
                    calories: '2500-3000 ккал',
                    protein: '120-150 г',
                    carbs: '300-400 г',
                    fat: '70-90 г',
                    tips: [
                        'Углеводы за 2 часа до тренировки (овсянка, рис)',
                        'Белок после тренировки в течение 30 минут (сывороточный протеин)',
                        'Жиры из орехов и авокадо для здоровья суставов',
                        'Гидратация: 30-40 мл на кг веса в день'
                    ]
                },
                supplements: [
                    { 
                        name: 'BCAA', 
                        description: 'Снижает мышечную усталость, ускоряет восстановление после интенсивных тренировок' 
                    },
                    { 
                        name: 'Электролиты', 
                        description: 'Восполняют потерю солей при интенсивном потоотделении, предотвращают судороги' 
                    },
                    { 
                        name: 'Омега-3', 
                        description: 'Уменьшает воспаление, поддерживает здоровье суставов и сердечно-сосудистой системы' 
                    },
                    { 
                        name: 'Коллаген', 
                        description: 'Укрепляет связки и суставы, снижает риск травм' 
                    }
                ]
            },
            basketball: {
                id: 'basketball',
                name: 'Баскетбол',
                description: 'Координация, прыжки, скорость',
                icon: '<svg viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="20" cy="20" r="18" stroke="currentColor" stroke-width="2"/><path d="M20 12V28M12 20H28" stroke="currentColor" stroke-width="2"/><circle cx="20" cy="20" r="6" stroke="currentColor" stroke-width="2"/></svg>',
                category: 'team',
                recommendations: {
                    morning: [
                        'Прыжковые упражнения: 10 минут',
                        'Броски с разных точек',
                        'Скакалка 5 минут'
                    ],
                    day: [
                        'Силовая тренировка: приседания, выпады',
                        'Дриблинг с сопротивлением',
                        'Игровые упражнения 3 на 3'
                    ],
                    evening: [
                        'Растяжка и восстановление',
                        'Просмотр игровых моментов',
                        'Медитация для концентрации'
                    ]
                },
                workouts: [
                    { name: 'Приседания со штангой', sets: '4', reps: '8-10 повторений', rest: '120 секунд' },
                    { name: 'Выпады с гантелями', sets: '3', reps: '10-12 на каждую ногу', rest: '90 секунд' },
                    { name: 'Подъемы на носки', sets: '4', reps: '15-20 повторений', rest: '60 секунд' },
                    { name: 'Прыжки на тумбу', sets: '4', reps: '8-10 повторений', rest: '90 секунд' },
                    { name: 'Берпи', sets: '3', reps: '10-12 повторений', rest: '60 секунд' }
                ],
                nutrition: {
                    calories: '2700-3200 ккал',
                    protein: '130-160 г',
                    carbs: '350-450 г',
                    fat: '75-95 г',
                    tips: [
                        'Быстрые углеводы перед игрой (банан, энергетический батончик)',
                        'Белок с каждым приемом пищи для восстановления мышц',
                        'Антиоксиданты из ягод для уменьшения воспаления',
                        'Кофеин за 30 минут до игры для повышения концентрации'
                    ]
                },
                supplements: [
                    { 
                        name: 'Креатин', 
                        description: 'Увеличивает взрывную силу и мощность прыжка, улучшает силовые показатели' 
                    },
                    { 
                        name: 'Бета-аланин', 
                        description: 'Повышает выносливость, уменьшает мышечную усталость во время интенсивных нагрузок' 
                    },
                    { 
                        name: 'Цитруллин малат', 
                        description: 'Улучшает кровоток и доставку кислорода к мышцам, уменьшает мышечную боль' 
                    },
                    { 
                        name: 'Витамин С', 
                        description: 'Укрепляет иммунитет, особенно важно в периоды интенсивных тренировок' 
                    }
                ]
            },
            volleyball: {
                id: 'volleyball',
                name: 'Волейбол',
                description: 'Реакция, команда, прыгучесть',
                icon: '<svg viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="20" cy="20" r="18" stroke="currentColor" stroke-width="2"/><path d="M12 16L28 24M28 16L12 24M20 10V30" stroke="currentColor" stroke-width="2"/></svg>',
                category: 'team',
                recommendations: {
                    morning: [
                        'Утренняя разминка с акцентом на плечи',
                        'Упражнения на реакцию',
                        'Прыжки на скакалке'
                    ],
                    day: [
                        'Тренировка подач и приема',
                        'Игровые комбинации',
                        'Блокирование у сетки'
                    ],
                    evening: [
                        'Восстановительные процедуры',
                        'Анализ техники',
                        'Растяжка мышц спины'
                    ]
                },
                workouts: [
                    { name: 'Жим штанги стоя', sets: '4', reps: '8-10 повторений', rest: '90 секунд' },
                    { name: 'Тяга штанги к подбородку', sets: '3', reps: '10-12 повторений', rest: '60 секунд' },
                    { name: 'Прыжки из приседа', sets: '4', reps: '8-10 повторений', rest: '90 секунд' },
                    { name: 'Отжимания на брусьях', sets: '3', reps: '10-12 повторений', rest: '60 секунд' },
                    { name: 'Планка с поворотами', sets: '3', reps: '30-45 секунд', rest: '30 секунд' }
                ],
                nutrition: {
                    calories: '2400-2900 ккал',
                    protein: '120-150 г',
                    carbs: '300-380 г',
                    fat: '65-85 г',
                    tips: [
                        'Углеводы средней скорости усвоения за 1.5 часа до тренировки',
                        'Белок с высоким содержанием лейцина для синтеза мышц',
                        'Полезные жиры для здоровья суставов и гормонального фона',
                        'Достаточное количество соли для поддержания электролитного баланса'
                    ]
                },
                supplements: [
                    { 
                        name: 'Глюкозамин + Хондроитин', 
                        description: 'Поддерживает здоровье суставов, особенно важно для прыжковых видов спорта' 
                    },
                    { 
                        name: 'MSM (Метилсульфонилметан)', 
                        description: 'Уменьшает воспаление в суставах, ускоряет восстановление' 
                    },
                    { 
                        name: 'Магний', 
                        description: 'Снижает мышечные спазмы, улучшает качество сна и восстановления' 
                    },
                    { 
                        name: 'Витамин D3', 
                        description: 'Укрепляет кости, поддерживает иммунную систему, особенно при тренировках в зале' 
                    }
                ]
            },
            gym: {
                id: 'gym',
                name: 'Тренажерный зал',
                description: 'Сила, здоровье, эстетика',
                icon: '<svg viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg"><rect x="8" y="8" width="24" height="24" rx="4" stroke="currentColor" stroke-width="2"/><path d="M16 12V28M24 12V28M12 16H28M12 24H28" stroke="currentColor" stroke-width="2"/></svg>',
                category: 'strength',
                goals: {
                    muscle: {
                        name: 'Набор мышечной массы',
                        workouts: [
                            { name: 'Жим штанги лежа', sets: '4', reps: '8-10 повторений', rest: '120 секунд' },
                            { name: 'Приседания со штангой', sets: '4', reps: '8-10 повторений', rest: '120 секунд' },
                            { name: 'Тяга штанги в наклоне', sets: '4', reps: '8-10 повторений', rest: '120 секунд' },
                            { name: 'Армейский жим', sets: '3', reps: '8-10 повторений', rest: '90 секунд' },
                            { name: 'Подтягивания широким хватом', sets: '3', reps: '6-8 повторений', rest: '90 секунд' }
                        ],
                        nutrition: {
                            calories: '3000-3500 ккал',
                            protein: '150-200 г',
                            carbs: '400-500 г',
                            fat: '80-100 г',
                            tips: [
                                'Протеиновый коктейль сразу после тренировки',
                                'Углеводы в течение дня для поддержания энергии',
                                'Жиры для выработки тестостерона и гормонального здоровья',
                                'Питание каждые 3-4 часа для постоянного поступления нутриентов'
                            ]
                        },
                        supplements: [
                            { 
                                name: 'Сывороточный протеин', 
                                description: 'Быстро усваиваемый белок для синтеза мышц после тренировки' 
                            },
                            { 
                                name: 'Креатин моногидрат', 
                                description: 'Увеличивает силу, мощность и мышечную массу, улучшает гидратацию клеток' 
                            },
                            { 
                                name: 'BCAA', 
                                description: 'Снижает катаболизм, ускоряет восстановление между тренировками' 
                            },
                            { 
                                name: 'Цинк + Магний + B6 (ZMA)', 
                                description: 'Улучшает качество сна, повышает уровень тестостерона' 
                            }
                        ]
                    },
                    shape: {
                        name: 'Форма и рельеф',
                        workouts: [
                            { name: 'Суперсет: бицепс + трицепс', sets: '3', reps: '12-15 повторений', rest: '60 секунд' },
                            { name: 'Кардио на беговой дорожке', sets: '1', reps: '30-40 минут', rest: '0' },
                            { name: 'Планка с вариациями', sets: '3', reps: '60 секунд', rest: '30 секунд' },
                            { name: 'Выпады с гантелями', sets: '3', reps: '12-15 на каждую ногу', rest: '60 секунд' },
                            { name: 'Жим гантелей на наклонной скамье', sets: '3', reps: '12-15 повторений', rest: '60 секунд' }
                        ],
                        nutrition: {
                            calories: '2000-2500 ккал',
                            protein: '120-150 г',
                            carbs: '200-250 г',
                            fat: '50-70 г',
                            tips: [
                                'Контроль углеводов во второй половине дня',
                                'Больше овощей для клетчатки и насыщения',
                                'Дробное питание 5-6 раз в день для контроля аппетита',
                                'Достаточное количество воды для подавления аппетита и метаболизма'
                            ]
                        },
                        supplements: [
                            { 
                                name: 'L-карнитин', 
                                description: 'Помогает транспортировать жирные кислоты в митохондрии для сжигания' 
                            },
                            { 
                                name: 'Зеленый чай экстракт', 
                                description: 'Ускоряет метаболизм, обладает антиоксидантными свойствами' 
                            },
                            { 
                                name: 'Омега-3', 
                                description: 'Снижает воспаление, улучшает чувствительность к инсулину' 
                            },
                            { 
                                name: 'Витаминно-минеральный комплекс', 
                                description: 'Восполняет дефициты при снижении калорийности рациона' 
                            }
                        ]
                    }
                }
            }
        };

        class SportAIPro {
            constructor() {
                this.state = {
                    userData: {},
                    testResults: { reaction: [], bodyweight: {} },
                    preferences: [],
                    favorites: [],
                    hasCompletedOnboarding: false,
                    theme: 'dark',
                    currentSportDetails: null,
                    currentGymGoal: 'muscle'
                };
                
                this.currentOnboardingStep = 1;
                this.reactionTest = null;
                this.reactionTimeouts = [];
                
                this.init();
            }
            
            init() {
                this.loadState();
                this.checkOnboarding();
                this.setupEventListeners();
                this.initTimeBasedContent();
            }
            
            loadState() {
                try {
                    const saved = localStorage.getItem('sportAIState');
                    if (saved) {
                        const parsed = JSON.parse(saved);
                        this.state = { ...this.state, ...parsed };
                    }
                } catch (e) {
                    console.error('Ошибка загрузки:', e);
                }
            }
            
            saveState() {
                localStorage.setItem('sportAIState', JSON.stringify(this.state));
                localStorage.setItem('user_tested', 'true');
            }
            
            checkOnboarding() {
                const userTested = localStorage.getItem('user_tested');
                this.state.hasCompletedOnboarding = !!userTested;
                
                if (!this.state.hasCompletedOnboarding) {
                    document.getElementById('onboarding').classList.remove('hidden');
                    document.getElementById('mainApp').classList.add('d-none');
                    this.showOnboardingStep(1);
                } else {
                    document.getElementById('onboarding').classList.add('hidden');
                    document.getElementById('mainApp').classList.remove('d-none');
                    this.updateHomeContent();
                    this.updateProfile();
                    this.updateSportsGrid();
                }
            }
            
            setupEventListeners() {
                // Настройка кнопок выбора предпочтений
                document.querySelectorAll('.test-option-btn').forEach(btn => {
                    btn.addEventListener('click', () => {
                        btn.classList.toggle('selected');
                        const value = btn.dataset.value;
                        const index = this.state.preferences.indexOf(value);
                        
                        if (index > -1) {
                            this.state.preferences.splice(index, 1);
                        } else {
                            this.state.preferences.push(value);
                        }
                    });
                });

                // Настройка переключателя целей для зала
                document.addEventListener('click', (e) => {
                    if (e.target.classList.contains('goal-btn')) {
                        const goal = e.target.dataset.goal;
                        this.state.currentGymGoal = goal;
                        
                        // Обновляем активную кнопку
                        document.querySelectorAll('.goal-btn').forEach(btn => {
                            btn.classList.remove('active');
                        });
                        e.target.classList.add('active');
                        
                        // Обновляем детали для зала
                        if (this.state.currentSportDetails === 'gym') {
                            this.showSportDetails('gym');
                        }
                    }
                });
            }
            
            onboardingNext() {
                if (this.currentOnboardingStep === 2 && !this.validateBasicData()) {
                    return;
                }
                
                this.currentOnboardingStep++;
                if (this.currentOnboardingStep <= 4) {
                    this.showOnboardingStep(this.currentOnboardingStep);
                }
            }
            
            onboardingPrev() {
                this.currentOnboardingStep = Math.max(1, this.currentOnboardingStep - 1);
                this.showOnboardingStep(this.currentOnboardingStep);
            }
            
            showOnboardingStep(step) {
                document.querySelectorAll('.onboarding-step').forEach(stepEl => {
                    stepEl.classList.remove('active');
                });
                document.querySelectorAll('.progress-step').forEach((stepEl, index) => {
                    stepEl.classList.toggle('active', index < step);
                });
                
                document.getElementById(`onboardingStep${step}`).classList.add('active');
            }
            
            validateBasicData() {
                const age = document.getElementById('age').value;
                const gender = document.getElementById('gender').value;
                const height = document.getElementById('height').value;
                const weight = document.getElementById('weight').value;
                const wrist = document.getElementById('wrist').value;
                const ankle = document.getElementById('ankle').value;
                
                if (!age || !gender || !height || !weight || !wrist || !ankle) {
                    alert('Пожалуйста, заполните все поля');
                    return false;
                }
                
                this.state.userData = {
                    age: parseInt(age),
                    gender: gender,
                    height: parseInt(height),
                    weight: parseInt(weight),
                    wrist: parseFloat(wrist),
                    ankle: parseFloat(ankle)
                };
                
                return true;
            }
            
            startReactionTest() {
                this.clearAllTimeouts();
                
                this.state.testResults.reaction = [];
                document.getElementById('reactionAvg').textContent = '-';
                document.getElementById('reactionBest').textContent = '-';
                document.getElementById('reactionMessage').textContent = 'Приготовьтесь...';
                document.getElementById('startReaction').classList.add('d-none');
                document.getElementById('continueBtn').classList.add('d-none');
                
                const area = document.getElementById('reactionArea');
                area.innerHTML = '';
                area.style.cursor = 'pointer';
                
                this.reactionTest = {
                    startTime: null,
                    targetsShown: 0,
                    totalTargets: 5,
                    times: [],
                    completed: false
                };
                
                setTimeout(() => {
                    this.showNextReactionTarget();
                }, 1000);
            }
            
            showNextReactionTarget() {
                if (this.reactionTest.completed || this.reactionTest.targetsShown >= this.reactionTest.totalTargets) {
                    this.endReactionTest();
                    return;
                }
                
                const area = document.getElementById('reactionArea');
                area.innerHTML = '';
                
                const target = document.createElement('div');
                target.className = 'reaction-target';
                
                const margin = 40;
                const x = margin + Math.random() * (area.offsetWidth - margin * 2);
                const y = margin + Math.random() * (area.offsetHeight - margin * 2);
                
                target.style.left = `${x}px`;
                target.style.top = `${y}px`;
                
                target.addEventListener('mousedown', () => this.handleReactionHit(target));
                target.addEventListener('touchstart', (e) => {
                    this.handleReactionHit(target);
                    e.preventDefault();
                });
                
                area.appendChild(target);
                this.reactionTest.startTime = Date.now();
                this.reactionTest.targetsShown++;
                
                const timeout = setTimeout(() => {
                    if (target.parentElement && !this.reactionTest.completed) {
                        target.style.display = 'none';
                        const nextTimeout = setTimeout(() => {
                            this.showNextReactionTarget();
                        }, 300);
                        this.reactionTimeouts.push(nextTimeout);
                    }
                }, 1500);
                
                this.reactionTimeouts.push(timeout);
            }
            
            handleReactionHit(target) {
                if (this.reactionTest.completed) return;
                
                const reactionTime = Date.now() - this.reactionTest.startTime;
                this.reactionTest.times.push(reactionTime);
                
                const avg = this.reactionTest.times.length > 0 ? 
                    Math.round(this.reactionTest.times.reduce((a, b) => a + b) / this.reactionTest.times.length) : 0;
                const best = this.reactionTest.times.length > 0 ? Math.min(...this.reactionTest.times) : 0;
                
                document.getElementById('reactionAvg').textContent = `${avg}мс`;
                document.getElementById('reactionBest').textContent = `${best}мс`;
                
                this.clearAllTimeouts();
                
                target.style.display = 'none';
                
                const timeout = setTimeout(() => {
                    this.showNextReactionTarget();
                }, 300);
                this.reactionTimeouts.push(timeout);
            }
            
            endReactionTest() {
                this.reactionTest.completed = true;
                this.clearAllTimeouts();
                
                document.getElementById('reactionArea').innerHTML = 
                    '<div class="text-center" style="margin-top: 100px; color: var(--text-tertiary);">Тест завершен!</div>';
                
                this.state.testResults.reaction = this.reactionTest.times;
                this.saveState();
                
                document.getElementById('continueBtn').classList.remove('d-none');
            }
            
            clearAllTimeouts() {
                this.reactionTimeouts.forEach(timeout => clearTimeout(timeout));
                this.reactionTimeouts = [];
            }
            
            calculateFitnessLevel() {
                const bodyweight = this.state.testResults.bodyweight;
                if (!bodyweight) return;
                
                let score = 0;
                if (bodyweight.pushups >= 30) score += 30;
                else if (bodyweight.pushups >= 20) score += 25;
                else if (bodyweight.pushups >= 15) score += 20;
                else if (bodyweight.pushups >= 10) score += 15;
                else if (bodyweight.pushups >= 5) score += 10;
                else if (bodyweight.pushups >= 1) score += 5;
                
                if (bodyweight.plank >= 180) score += 30;
                else if (bodyweight.plank >= 120) score += 25;
                else if (bodyweight.plank >= 90) score += 20;
                else if (bodyweight.plank >= 60) score += 15;
                else if (bodyweight.plank >= 30) score += 10;
                else if (bodyweight.plank >= 10) score += 5;
                
                if (bodyweight.pullups >= 10) score += 20;
                else if (bodyweight.pullups >= 5) score += 15;
                else if (bodyweight.pullups >= 3) score += 10;
                else if (bodyweight.pullups >= 1) score += 5;
                
                if (bodyweight.squats >= 50) score += 20;
                else if (bodyweight.squats >= 40) score += 15;
                else if (bodyweight.squats >= 30) score += 10;
                else if (bodyweight.squats >= 20) score += 5;
                
                let level, description;
                if (score >= 90) {
                    level = "Продвинутый";
                    description = "Отличная физическая форма!";
                } else if (score >= 70) {
                    level = "Выше среднего";
                    description = "Хорошая база для развития.";
                } else if (score >= 50) {
                    level = "Средний";
                    description = "Нормальный уровень для начала.";
                } else if (score >= 30) {
                    level = "Начинающий";
                    description = "Начнем с основ, главное - регулярность!";
                } else {
                    level = "Новичок";
                    description = "Идеальное время для начала тренировок!";
                }
                
                document.getElementById('fitnessLevel').textContent = level;
                document.getElementById('fitnessDescription').textContent = description;
            }
            
            completeOnboarding() {
                this.state.testResults.bodyweight = {
                    pushups: parseInt(document.getElementById('pushups').value) || 0,
                    plank: parseInt(document.getElementById('plank').value) || 0,
                    pullups: parseInt(document.getElementById('pullups').value) || 0,
                    squats: parseInt(document.getElementById('squats').value) || 0
                };
                
                this.calculateFitnessLevel();
                this.state.hasCompletedOnboarding = true;
                
                localStorage.setItem('user_tested', 'true');
                this.saveState();
                
                document.getElementById('onboarding').classList.add('hidden');
                document.getElementById('mainApp').classList.remove('d-none');
                
                this.updateHomeContent();
                this.updateProfile();
                this.updateSportsGrid();
            }
            
            initTimeBasedContent() {
                this.updateTimeBasedContent();
                setInterval(() => this.updateTimeBasedContent(), 60000);
            }
            
            updateTimeBasedContent() {
                const hours = new Date().getHours();
                let period, greeting;
                
                if (hours >= 6 && hours < 11) {
                    period = 'morning';
                    greeting = 'Доброе утро!';
                } else if (hours >= 11 && hours < 18) {
                    period = 'day';
                    greeting = 'Добрый день!';
                } else {
                    period = 'evening';
                    greeting = 'Добрый вечер!';
                }
                
                document.getElementById('greetingText').textContent = greeting;
                document.getElementById('timePeriod').textContent = 
                    period === 'morning' ? 'Утренние рекомендации' :
                    period === 'day' ? 'Дневные рекомендации' : 'Вечерние рекомендации';
                
                this.updateTodayRecommendations(period);
            }
            
            updateTodayRecommendations(period) {
                const container = document.getElementById('todayRecommendations');
                let html = `
                    <div class="recommendation-card">
                        <div class="recommendation-header">
                            <svg class="recommendation-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M12 2V6" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                                <path d="M4.93 4.93L7.76 7.76" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                                <path d="M2 12H6" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                                <path d="M4.93 19.07L7.76 16.24" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                                <path d="M12 18V22" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                                <path d="M16.24 16.24L19.07 19.07" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                                <path d="M18 12H22" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                                <path d="M16.24 7.76L19.07 4.93" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                            </svg>
                            <div class="recommendation-title">Рекомендации на ${period === 'morning' ? 'утро' : period === 'day' ? 'день' : 'вечер'}</div>
                        </div>
                        <ul class="recommendation-list">
                `;
                
                const tips = [
                    'Выпейте стакан воды комнатной температуры',
                    period === 'morning' ? 'Легкий завтрак за 30-60 минут до активности' : 
                    period === 'day' ? 'Основной прием пищи за 2-3 часа до тренировки' : 'Легкий ужин за 2-3 часа до сна',
                    'Разминка 10-15 минут перед основной активностью',
                    'Восстановление и растяжка после тренировки'
                ];
                
                tips.forEach(tip => {
                    html += `
                        <li class="recommendation-item">
                            <svg class="check-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M20 6L9 17L4 12" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                            ${tip}
                        </li>
                    `;
                });
                
                html += `</ul></div>`;
                container.innerHTML = html;
            }
            
            showSection(sectionId) {
                document.querySelectorAll('.section').forEach(section => {
                    section.classList.remove('active');
                });
                document.querySelectorAll('.nav-btn').forEach(btn => {
                    btn.classList.remove('active');
                });
                
                document.getElementById(sectionId).classList.add('active');
                document.querySelector(`[onclick="SportAI.showSection('${sectionId}')"]`).classList.add('active');
            }
            
            showAnalysisTab(tabId) {
                document.querySelectorAll('.analysis-content').forEach(content => {
                    content.classList.remove('active');
                });
                document.querySelectorAll('.analysis-tab').forEach(tab => {
                    tab.classList.remove('active');
                });
                
                const tabName = tabId.charAt(0).toUpperCase() + tabId.slice(1);
                document.getElementById('analysis' + tabName).classList.add('active');
                document.querySelector(`[onclick="SportAI.showAnalysisTab('${tabId}')"]`).classList.add('active');
                
                if (tabId === 'data') {
                    this.populateUpdateForm();
                } else if (tabId === 'results') {
                    this.updateAnalysisResults();
                }
            }
            
            updateHomeContent() {
                const favoriteSport = this.getFavoriteSport();
                const favoriteSection = document.getElementById('favoriteSportSection');
                
                if (favoriteSport) {
                    favoriteSection.innerHTML = `
                        <h3 class="h3">Твой основной спорт</h3>
                        <div class="sport-card-large mt-2" onclick="SportAI.showSportDetails('${favoriteSport.id}')">
                            <div class="sport-icon-large">
                                ${favoriteSport.icon}
                            </div>
                            <div class="sport-info">
                                <div class="sport-name">${favoriteSport.name}</div>
                                <div class="sport-desc">${favoriteSport.description}</div>
                            </div>
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M9 18L15 12L9 6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                        </div>
                    `;
                } else {
                    favoriteSection.innerHTML = `
                        <h3 class="h3">Выберите основной спорт</h3>
                        <p class="subtitle">Отметьте спорт звездочкой, чтобы закрепить его здесь</p>
                        <button class="btn btn-primary mt-2" onclick="SportAI.showSection('sports')">
                            Выбрать спорт
                        </button>
                    `;
                }
            }
            
            updateSportsGrid() {
                const container = document.getElementById('sportsGrid');
                container.innerHTML = '';
                
                Object.values(SPORTS_DATABASE).forEach(sport => {
                    const isFavorite = this.state.favorites.includes(sport.id);
                    
                    const card = document.createElement('div');
                    card.className = `sport-card ${isFavorite ? 'favorite' : ''}`;
                    card.innerHTML = `
                        <div class="favorite-star" onclick="event.stopPropagation(); SportAI.toggleFavorite('${sport.id}')">
                            ${isFavorite ? 
                                '<svg viewBox="0 0 24 24" fill="#F59E0B" xmlns="http://www.w3.org/2000/svg"><path d="M12 2L15.09 8.26L22 9.27L17 14.14L18.18 21.02L12 17.77L5.82 21.02L7 14.14L2 9.27L8.91 8.26L12 2Z" stroke="#F59E0B" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>' :
                                '<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 2L15.09 8.26L22 9.27L17 14.14L18.18 21.02L12 17.77L5.82 21.02L7 14.14L2 9.27L8.91 8.26L12 2Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>'
                            }
                        </div>
                        <div class="sport-icon">
                            ${sport.icon}
                        </div>
                        <div class="sport-name">${sport.name}</div>
                        <div class="text-muted" style="font-size: var(--font-xs);">${sport.description}</div>
                    `;
                    
                    card.addEventListener('click', () => {
                        this.showSportDetails(sport.id);
                    });
                    
                    container.appendChild(card);
                });
            }
            
            getFavoriteSport() {
                if (this.state.favorites.length > 0) {
                    return SPORTS_DATABASE[this.state.favorites[0]];
                }
                return null;
            }
            
            toggleFavorite(sportId) {
                const index = this.state.favorites.indexOf(sportId);
                
                if (index > -1) {
                    this.state.favorites.splice(index, 1);
                } else {
                    if (this.state.favorites.length < 3) {
                        this.state.favorites.push(sportId);
                    } else {
                        alert('Можно выбрать не более 3 избранных видов спорта');
                        return;
                    }
                }
                
                this.saveState();
                this.updateSportsGrid();
                this.updateHomeContent();
            }
            
            showSportDetails(sportId) {
                this.state.currentSportDetails = sportId;
                const sport = SPORTS_DATABASE[sportId];
                
                if (!sport) return;
                
                document.getElementById('sportDetailsTitle').textContent = sport.name;
                
                // Показываем или скрываем переключатель целей для зала
                const goalSelector = document.getElementById('gymGoalSelector');
                if (sportId === 'gym') {
                    goalSelector.classList.remove('d-none');
                    
                    // Устанавливаем активную цель
                    document.querySelectorAll('.goal-btn').forEach(btn => {
                        btn.classList.toggle('active', btn.dataset.goal === this.state.currentGymGoal);
                    });
                    
                    this.updateGymDetails(sport, this.state.currentGymGoal);
                } else {
                    goalSelector.classList.add('d-none');
                    this.updateRegularSportDetails(sport);
                }
                
                document.getElementById('sportDetailsModal').classList.add('active');
            }
            
            updateRegularSportDetails(sport) {
                // Тренировки
                const workoutList = document.getElementById('workoutList');
                workoutList.innerHTML = sport.workouts.map(workout => `
                    <li class="workout-item">
                        <div class="workout-name">${workout.name}</div>
                        <div class="workout-details">
                            Подходы: ${workout.sets} | Повторения: ${workout.reps} | Отдых: ${workout.rest}
                        </div>
                    </li>
                `).join('');
                
                // Питание
                const nutritionGrid = document.getElementById('nutritionGrid');
                nutritionGrid.innerHTML = `
                    <div class="nutrition-item">
                        <div class="nutrition-value">${sport.nutrition.calories}</div>
                        <div class="nutrition-label">Калории</div>
                    </div>
                    <div class="nutrition-item">
                        <div class="nutrition-value">${sport.nutrition.protein}</div>
                        <div class="nutrition-label">Белок</div>
                    </div>
                    <div class="nutrition-item">
                        <div class="nutrition-value">${sport.nutrition.carbs}</div>
                        <div class="nutrition-label">Углеводы</div>
                    </div>
                    <div class="nutrition-item">
                        <div class="nutrition-value">${sport.nutrition.fat}</div>
                        <div class="nutrition-label">Жиры</div>
                    </div>
                `;
                
                // Советы по питанию
                const nutritionTips = document.getElementById('nutritionTips');
                nutritionTips.innerHTML = `
                    <ul class="workout-list">
                        ${sport.nutrition.tips.map(tip => `<li class="workout-item" style="border: none; padding: var(--spacing-xs);">${tip}</li>`).join('')}
                    </ul>
                `;
                
                // Добавки
                const supplementsList = document.getElementById('supplementsList');
                supplementsList.innerHTML = sport.supplements.map(supplement => `
                    <li class="supplement-item">
                        <div class="supplement-name">${supplement.name}</div>
                        <div class="supplement-desc">${supplement.description}</div>
                    </li>
                `).join('');
            }
            
            updateGymDetails(sport, goal) {
                const goalData = sport.goals[goal];
                
                // Тренировки
                const workoutList = document.getElementById('workoutList');
                workoutList.innerHTML = goalData.workouts.map(workout => `
                    <li class="workout-item">
                        <div class="workout-name">${workout.name}</div>
                        <div class="workout-details">
                            Подходы: ${workout.sets} | Повторения: ${workout.reps} | Отдых: ${workout.rest}
                        </div>
                    </li>
                `).join('');
                
                // Питание
                const nutritionGrid = document.getElementById('nutritionGrid');
                nutritionGrid.innerHTML = `
                    <div class="nutrition-item">
                        <div class="nutrition-value">${goalData.nutrition.calories}</div>
                        <div class="nutrition-label">Калории</div>
                    </div>
                    <div class="nutrition-item">
                        <div class="nutrition-value">${goalData.nutrition.protein}</div>
                        <div class="nutrition-label">Белок</div>
                    </div>
                    <div class="nutrition-item">
                        <div class="nutrition-value">${goalData.nutrition.carbs}</div>
                        <div class="nutrition-label">Углеводы</div>
                    </div>
                    <div class="nutrition-item">
                        <div class="nutrition-value">${goalData.nutrition.fat}</div>
                        <div class="nutrition-label">Жиры</div>
                    </div>
                `;
                
                // Советы по питанию
                const nutritionTips = document.getElementById('nutritionTips');
                nutritionTips.innerHTML = `
                    <ul class="workout-list">
                        ${goalData.nutrition.tips.map(tip => `<li class="workout-item" style="border: none; padding: var(--spacing-xs);">${tip}</li>`).join('')}
                    </ul>
                `;
                
                // Добавки
                const supplementsList = document.getElementById('supplementsList');
                supplementsList.innerHTML = goalData.supplements.map(supplement => `
                    <li class="supplement-item">
                        <div class="supplement-name">${supplement.name}</div>
                        <div class="supplement-desc">${supplement.description}</div>
                    </li>
                `).join('');
            }
            
            closeSportDetails() {
                document.getElementById('sportDetailsModal').classList.remove('active');
                this.state.currentSportDetails = null;
            }
            
            updateProfile() {
                const avatar = document.getElementById('profileAvatar');
                const name = document.getElementById('profileName');
                
                if (this.state.userData.gender) {
                    avatar.textContent = this.state.userData.gender === 'male' ? 'М' : 'Ж';
                }
                
                const age = document.getElementById('profileAge');
                const gender = document.getElementById('profileGender');
                
                if (this.state.userData.age) {
                    age.textContent = `${this.state.userData.age} лет`;
                }
                
                if (this.state.userData.gender) {
                    gender.textContent = this.state.userData.gender === 'male' ? 'Мужской' : 'Женский';
                }
                
                const bmi = this.calculateBMI();
                const bmiElement = document.getElementById('profileBmi');
                if (bmi) {
                    bmiElement.textContent = bmi.toFixed(1);
                }
                
                const bodyType = this.calculateBodyType();
                const bodyTypeElement = document.getElementById('profileBodyType');
                if (bodyType) {
                    bodyTypeElement.textContent = bodyType.name;
                }
                
                this.updatePersonalRecords();
            }
            
            calculateBMI() {
                if (!this.state.userData.height || !this.state.userData.weight) {
                    return null;
                }
                
                const heightM = this.state.userData.height / 100;
                return this.state.userData.weight / (heightM * heightM);
            }
            
            calculateBodyType() {
                if (!this.state.userData.wrist || !this.state.userData.height || !this.state.userData.gender) {
                    return null;
                }
                
                const solovyovIndex = (this.state.userData.wrist * this.state.userData.height) / 240;
                
                let bodyType;
                if (this.state.userData.gender === 'male') {
                    if (solovyovIndex < 15) bodyType = { name: 'Астеник', desc: 'Худощавое телосложение' };
                    else if (solovyovIndex <= 17) bodyType = { name: 'Нормостеник', desc: 'Среднее телосложение' };
                    else bodyType = { name: 'Гиперстеник', desc: 'Крупное телосложение' };
                } else {
                    if (solovyovIndex < 13) bodyType = { name: 'Астеник', desc: 'Худощавое телосложение' };
                    else if (solovyovIndex <= 15) bodyType = { name: 'Нормостеник', desc: 'Среднее телосложение' };
                    else bodyType = { name: 'Гиперстеник', desc: 'Крупное телосложение' };
                }
                
                return bodyType;
            }
            
            updatePersonalRecords() {
                const container = document.getElementById('personalRecords');
                
                if (!this.state.testResults.bodyweight || Object.keys(this.state.testResults.bodyweight).length === 0) {
                    container.innerHTML = `
                        <div class="text-center text-muted" style="padding: var(--spacing-md);">
                            Пройдите тестирование
                        </div>
                    `;
                    return;
                }
                
                const records = [
                    { name: 'Отжимания', value: this.state.testResults.bodyweight.pushups, unit: 'раз' },
                    { name: 'Планка', value: this.state.testResults.bodyweight.plank, unit: 'сек' },
                    { name: 'Подтягивания', value: this.state.testResults.bodyweight.pullups, unit: 'раз' },
                    { name: 'Приседания', value: this.state.testResults.bodyweight.squats, unit: 'раз' }
                ];
                
                let html = '';
                records.forEach(record => {
                    if (record.value > 0) {
                        html += `
                            <li class="record-item">
                                <div class="record-info">
                                    <div class="record-name">${record.name}</div>
                                    <div class="record-date">Последний тест</div>
                                </div>
                                <div class="record-value">${record.value} ${record.unit}</div>
                            </li>
                        `;
                    }
                });
                
                if (html === '') {
                    html = `
                        <div class="text-center text-muted" style="padding: var(--spacing-md);">
                            Пока нет рекордов
                        </div>
                    `;
                }
                
                container.innerHTML = html;
            }
            
            populateUpdateForm() {
                if (this.state.userData.height) {
                    document.getElementById('updateHeight').value = this.state.userData.height;
                }
                if (this.state.userData.weight) {
                    document.getElementById('updateWeight').value = this.state.userData.weight;
                }
                if (this.state.userData.wrist) {
                    document.getElementById('updateWrist').value = this.state.userData.wrist;
                }
                if (this.state.userData.ankle) {
                    document.getElementById('updateAnkle').value = this.state.userData.ankle;
                }
                if (this.state.testResults.bodyweight.pushups !== undefined) {
                    document.getElementById('updatePushups').value = this.state.testResults.bodyweight.pushups;
                }
                if (this.state.testResults.bodyweight.plank !== undefined) {
                    document.getElementById('updatePlank').value = this.state.testResults.bodyweight.plank;
                }
                if (this.state.testResults.bodyweight.pullups !== undefined) {
                    document.getElementById('updatePullups').value = this.state.testResults.bodyweight.pullups;
                }
                if (this.state.testResults.bodyweight.squats !== undefined) {
                    document.getElementById('updateSquats').value = this.state.testResults.bodyweight.squats;
                }
            }
            
            updateUserData() {
                const height = parseInt(document.getElementById('updateHeight').value);
                const weight = parseInt(document.getElementById('updateWeight').value);
                const wrist = parseFloat(document.getElementById('updateWrist').value);
                const ankle = parseFloat(document.getElementById('updateAnkle').value);
                
                if (!height || !weight || !wrist || !ankle) {
                    alert('Заполните все поля');
                    return;
                }
                
                this.state.userData.height = height;
                this.state.userData.weight = weight;
                this.state.userData.wrist = wrist;
                this.state.userData.ankle = ankle;
                
                this.saveState();
                this.updateProfile();
                alert('Данные обновлены!');
            }
            
            updateBodyweightTest() {
                const pushups = parseInt(document.getElementById('updatePushups').value) || 0;
                const plank = parseInt(document.getElementById('updatePlank').value) || 0;
                const pullups = parseInt(document.getElementById('updatePullups').value) || 0;
                const squats = parseInt(document.getElementById('updateSquats').value) || 0;
                
                this.state.testResults.bodyweight = {
                    pushups: pushups,
                    plank: plank,
                    pullups: pullups,
                    squats: squats
                };
                
                this.saveState();
                this.calculateFitnessLevel();
                this.updateProfile();
                alert('Рекорды обновлены!');
            }
            
            updateAnalysisResults() {
                // Реакция
                if (this.state.testResults.reaction && this.state.testResults.reaction.length > 0) {
                    const avg = Math.round(this.state.testResults.reaction.reduce((a, b) => a + b) / this.state.testResults.reaction.length);
                    let reactionLevel;
                    if (avg < 200) reactionLevel = 'Отличная';
                    else if (avg < 250) reactionLevel = 'Хорошая';
                    else if (avg < 300) reactionLevel = 'Средняя';
                    else reactionLevel = 'Низкая';
                    
                    document.getElementById('analysisReaction').textContent = reactionLevel;
                } else {
                    document.getElementById('analysisReaction').textContent = 'Не тестирована';
                }
                
                // Сила
                const strength = this.calculateStrengthScore();
                if (strength) {
                    let strengthLevel;
                    if (strength >= 80) strengthLevel = 'Высокий';
                    else if (strength >= 60) strengthLevel = 'Выше среднего';
                    else if (strength >= 40) strengthLevel = 'Средний';
                    else if (strength >= 20) strengthLevel = 'Ниже среднего';
                    else strengthLevel = 'Низкий';
                    
                    document.getElementById('analysisStrength').textContent = strengthLevel;
                } else {
                    document.getElementById('analysisStrength').textContent = 'Не тестирован';
                }
                
                // Соматотип
                const bodyType = this.calculateBodyType();
                if (bodyType) {
                    document.getElementById('analysisBodyType').textContent = bodyType.name;
                    document.getElementById('analysisBodyTypeDesc').textContent = bodyType.desc;
                }
                
                // BMI
                const bmi = this.calculateBMI();
                if (bmi) {
                    document.getElementById('analysisBmi').textContent = bmi.toFixed(1);
                    
                    let category;
                    if (bmi < 18.5) category = 'Недостаточный вес';
                    else if (bmi < 25) category = 'Нормальный вес';
                    else if (bmi < 30) category = 'Избыточный вес';
                    else category = 'Ожирение';
                    
                    document.getElementById('analysisBmiCategory').textContent = category;
                }
            }
            
            calculateStrengthScore() {
                const bodyweight = this.state.testResults.bodyweight;
                if (!bodyweight) return null;
                
                let score = 0;
                if (bodyweight.pushups > 0) score += Math.min(30, bodyweight.pushups * 1.5);
                if (bodyweight.pullups > 0) score += Math.min(30, bodyweight.pullups * 8);
                if (bodyweight.plank > 0) score += Math.min(20, bodyweight.plank / 3);
                if (bodyweight.squats > 0) score += Math.min(20, bodyweight.squats / 2);
                
                return Math.min(100, score);
            }
            
            resetApp() {
                if (confirm('Сбросить все данные и начать заново?')) {
                    localStorage.removeItem('sportAIState');
                    localStorage.removeItem('user_tested');
                    location.reload();
                }
            }
        }

        // Инициализация приложения
        const SportAI = new SportAIPro();
        window.SportAI = SportAI;

        // Инициализация после загрузки DOM
        document.addEventListener('DOMContentLoaded', () => {
            SportAI.updateTimeBasedContent();
            document.documentElement.setAttribute('data-theme', SportAI.state.theme);
        });
    </script>
</body>
</html>
